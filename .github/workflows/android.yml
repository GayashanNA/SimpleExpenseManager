#name: Android CI
#
#on:
#  push:
#    branches: [ master ]
#  pull_request:
#    branches: [ master ]
#
#jobs:
#  build:
#
#    runs-on: ubuntu-latest
#
#    steps:
#    - uses: actions/checkout@v3
#    - name: set up JDK 11
#      uses: actions/setup-java@v3
#      with:
#        java-version: '11'
#        distribution: 'temurin'
#        cache: gradle
#
##    - name: Grant execute permission for gradlew
##      run: chmod +x ./gradlew
#
#    - name: Run Tests
#      run: ./gradlew test
#
#    - name: Build Project
#      run: ./gradlew assemble
#
##    - name: Build with Gradle
##      run: ./gradlew build
#

## 1
name: Test and deploy

## Actions that will be executed when you push code currently none
on:
  push:

## 2
jobs:
  ## 3
  android_tests:
    runs-on: [ macos-latest ]
    steps:
      - uses: actions/checkout@v2

      - name: Make gradlew executable
        run: chmod +x ./gradlew

      - name: Instrumentation Tests
        uses: reactivecircus/android-emulator-runner@v2
        with:
          api-level: 26
          script: ./gradlew connectedAndroidTest

#name: Build
#
#on:
#  push:
#    branches: [ master ] # Just in case main was not up to date while merging PR
#  pull_request:
#    types: [ opened, synchronize ]
#
#jobs:
#  build-and-test:
#    name: Build, Lint and Test
#    runs-on: macos-latest
#    timeout-minutes: 20
#
#    steps:
#      - name: Checkout
#        uses: actions/checkout@v2
#
#      - name: Set up our JDK environment
#        uses: actions/setup-java@v2
#        with:
#          distribution: 'adopt'
#          java-version: '11'
#
#      - name: Cache Gradle and wrapper
#        uses: actions/cache@v2
#        with:
#          path: |
#            ~/.gradle/caches
#            ~/.gradle/wrapper
#          key: ${{ runner.os }}-gradle-${{ hashFiles('**/*.gradle*') }}
#          restore-keys: |
#            ${{ runner.os }}-gradle-
#
#      # Decode Google services configuration file from secrets
#      # - name: Decode google-services.json
#      #  env:
#      #    FIREBASE_CONFIG: ${{ secrets.FIREBASE_CONFIG }}
#      #  run: echo $FIREBASE_CONFIG > app/google-services.json
#
#      # Run emulator
#      - name: Run integration test on emulator
#        uses: reactivecircus/android-emulator-runner@v2
#        with:
#          api-level: 29
#          script: ./gradlew createDebugCoverageReport --stacktrace
#
#      # Generate jacoco report
#      - name: Generate report
#        run: ./gradlew jacocoTestReport
#
#      # Upload report
#      - name: Upload Reports
#        uses: actions/upload-artifact@v2
#        if: always()
#        with:
#          name: reports
#          path: |
#            /build/coverage-report
#            app/build/reports
#
#      # Upload coverage report to Codacy
#      - name: Run codacy-coverage-reporter
#        uses: codacy/codacy-coverage-reporter-action@v1
#        with:
#          project-token: ${{ secrets.CODACY_PROJECT_TOKEN }}